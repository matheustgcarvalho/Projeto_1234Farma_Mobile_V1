<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>1234Farma - Meus Pedidos</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root { 
            --tech-purple: #2E1A47;
            --neon-mint: #00D284;
            --page-bg: #F8F9FA;       
            --card-white: #FFFFFF;
            --text-gray: #666;
            --border-color: #EEE;
            --element-bg: #E9ECEF;
            --warning-red: #ff4757;
        }

        * { 
            margin: 0; padding: 0; box-sizing: border-box; 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            scrollbar-width: none;
        }
        *::-webkit-scrollbar { display: none; }
        
        body { background-color: var(--page-bg); color: var(--tech-purple); min-height: 100vh; padding-bottom: 80px; overflow-y: scroll; }

        /* === HEADER FIXO === */
        .fixed-header {
            position: fixed; top: 0; left: 0; width: 100%;
            background-color: var(--card-white); z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding-top: 30px;
        }

        .header-top { display: flex; align-items: center; padding: 15px 20px; }
        .header-title { flex-grow: 1; text-align: center; font-weight: 800; font-size: 1.1rem; }
        .btn-back { cursor: pointer; color: var(--tech-purple); }

        .filter-section { padding: 0 15px 15px 15px; }
        .search-bar-wrapper { display: flex; gap: 10px; align-items: center; }

        .search-input-container {
            flex-grow: 1;
            position: relative;
            background-color: var(--element-bg);
            border-radius: 20px;
            height: 42px;
            display: flex;
            align-items: center;
        }

        .search-icon-span { position: absolute; left: 15px; font-size: 1.2rem; color: var(--tech-purple); opacity: 0.5; }

        .search-box {
            width: 100%; background: transparent; border: none;
            padding: 0 15px 0 45px; font-size: 0.9rem; color: var(--tech-purple); outline: none;
        }

        .date-trigger {
            width: 42px; height: 42px; border-radius: 50%;
            background-color: var(--element-bg);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; color: var(--tech-purple);
            border: none; outline: none;
        }

        #dateInput { position: absolute; visibility: hidden; width: 0; height: 0; }

        .quick-filters { display: flex; gap: 8px; margin-top: 15px; overflow-x: auto; }
        .chip { 
            padding: 8px 16px; border-radius: 20px; background: #EEE; 
            font-size: 0.75rem; font-weight: 700; color: var(--text-gray); 
            white-space: nowrap; cursor: pointer;
        }
        .chip.active { background: var(--tech-purple); color: var(--neon-mint); }

        main { padding: 220px 15px 20px 15px; }

        /* === STATES (BLOQUEIO/EMPTY) === */
        .status-container { text-align: center; padding: 60px 20px; display: none; flex-direction: column; align-items: center; }
        .status-container .material-icons { font-size: 4.5rem; color: #DDD; margin-bottom: 20px; }
        .status-container h3 { font-size: 1.1rem; font-weight: 800; margin-bottom: 10px; color: var(--tech-purple); }
        .status-container p { color: #888; font-size: 0.9rem; line-height: 1.4; margin-bottom: 25px; }
        .btn-action { display: inline-block; padding: 14px 30px; background: var(--tech-purple); color: var(--neon-mint); text-decoration: none; border-radius: 15px; font-weight: 800; font-size: 0.85rem; text-transform: uppercase; border: none; cursor: pointer; }

        /* === CARD DE PEDIDO === */
        .order-card {
            background-color: var(--card-white); border-radius: 20px;
            padding: 18px; margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.04); border: 1px solid var(--border-color);
        }

        .order-header {
            display: flex; justify-content: space-between; align-items: flex-start;
            border-bottom: 1px solid var(--border-color); padding-bottom: 12px; margin-bottom: 12px;
        }

        .order-id { font-weight: 800; font-size: 0.95rem; display: block; }
        .order-date { font-size: 0.8rem; color: var(--text-gray); }
        
        .status-badge { font-size: 0.7rem; font-weight: 800; padding: 5px 10px; border-radius: 8px; text-transform: uppercase; }
        .status-retirado { background: #E8F5E9; color: #2E7D32; }
        .status-pendente { background: #FFF3E0; color: #EF6C00; border: 1px solid #EF6C00; animation: pulse 1.8s infinite; }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }

        .order-info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px; }
        .info-item { display: flex; flex-direction: column; gap: 3px; }
        .info-label { font-size: 0.65rem; color: #AAA; font-weight: 700; text-transform: uppercase; }
        .info-value { font-size: 0.85rem; font-weight: 700; color: var(--tech-purple); }

        .order-items-box { background: #F9FAFB; border-radius: 12px; padding: 12px; border: 1px solid #F0F0F0; }
        .item-row { display: flex; justify-content: space-between; font-size: 0.8rem; padding: 6px 0; border-bottom: 1px dashed #DDD; }
        .item-row:last-child { border-bottom: none; }
        .item-qty { color: var(--neon-mint); font-weight: 800; margin-right: 5px; }

        .order-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 15px; padding-top: 12px; border-top: 1px solid var(--border-color); }
        .total-value { font-size: 1.2rem; font-weight: 900; color: var(--tech-purple); }

        /* === MODAL DE LOGIN (BOTTOM SHEET) === */
        .login-modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 2000;
            display: none; align-items: flex-end;
            backdrop-filter: blur(2px);
        }
        .login-modal-overlay.active { display: flex; }
        .login-modal-content {
            width: 100%; background: white;
            border-top-left-radius: 30px; border-top-right-radius: 30px;
            padding: 20px 25px 40px 25px;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            max-height: 90vh; overflow-y: auto;
        }
        .login-modal-overlay.active .login-modal-content { transform: translateY(0); }
        .modal-drag-handle { width: 40px; height: 5px; background: #E0E0E0; border-radius: 10px; margin: 0 auto 20px auto; }

        .mobile-footer { position: fixed; bottom: 0; left: 0; width: 100%; background-color: var(--tech-purple); height: 60px; display: flex; justify-content: space-around; align-items: center; z-index: 500; border-top: 2px solid var(--neon-mint); }
        .nav-item { color: white; text-decoration: none; display: flex; flex-direction: column; align-items: center; gap: 2px; font-size: 0.55rem; font-weight: 600; opacity: 0.6; }
        .nav-item.active { color: var(--neon-mint); opacity: 1; }
        .nav-item .material-icons { font-size: 1.2rem; }
    </style>
</head>
<body>

    <div class="fixed-header">
        <div class="header-top">
            <span class="material-icons btn-back" onclick="window.location.href='loja_mobile.html'">arrow_back</span>
            <div class="header-title">Meus Pedidos</div>
            <div style="width: 24px;"></div>
        </div>
        
        <div class="filter-section" id="filterArea">
            <div class="search-bar-wrapper">
                <div class="search-input-container">
                    <span class="material-icons search-icon-span">search</span>
                    <input type="text" id="searchInput" class="search-box" placeholder="Buscar ID ou remédio..." onkeyup="filtrarGeral()">
                </div>
                
                <button class="date-trigger" onclick="abrirCalendario()">
                    <span class="material-icons">calendar_month</span>
                    <input type="date" id="dateInput" onchange="filtrarPorDataCalendario()">
                </button>
            </div>
            <div class="quick-filters">
                <div class="chip active" onclick="aplicarFiltroChip('todos', this)">Todos</div>
                <div class="chip" onclick="aplicarFiltroChip('pendente', this)">Pendentes</div>
                <div class="chip" onclick="aplicarFiltroChip('hoje', this)">Hoje</div>
                <div class="chip" onclick="aplicarFiltroChip('retirado', this)">Retirados</div>
            </div>
        </div>
    </div>

    <main>
        <div id="contentLogged" style="display: none;">
            <div id="containerPedidos">
                <div class="order-card" data-status="pendente" data-date-raw="2026-01-07">
                    <div class="order-header">
                        <div><span class="order-id">ID: #89102</span><span class="order-date">Hoje (07 Jan) • 16:10</span></div>
                        <span class="status-badge status-pendente">Aguardando Retirada</span>
                    </div>
                    <div class="order-info-grid">
                        <div class="info-item"><span class="info-label">Máquina</span><span class="info-value">M01 - Praça Central</span></div>
                        <div class="info-item"><span class="info-label">Pagamento</span><span class="info-value">PIX</span></div>
                        <div class="info-item"><span class="info-label">Hora Pedido</span><span class="info-value">16:10:05</span></div>
                        <div class="info-item"><span class="info-label">Status</span><span class="info-value">Pronto</span></div>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Advil 400mg</span><span>R$ 25,00</span></div>
                        <div class="item-row"><span><span class="item-qty">1x</span> Epocler 10ml</span><span>R$ 3,50</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 28,50</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2026-01-07">
                    <div class="order-header">
                        <div><span class="order-id">ID: #89155</span><span class="order-date">Hoje (07 Jan) • 14:20</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-info-grid">
                        <div class="info-item"><span class="info-label">Máquina</span><span class="info-value">M02 - Centro</span></div>
                        <div class="info-item"><span class="info-label">Pagamento</span><span class="info-value">Crédito</span></div>
                        <div class="info-item"><span class="info-label">Hora Pedido</span><span class="info-value">14:20:00</span></div>
                        <div class="info-item"><span class="info-label">Hora Retirada</span><span class="info-value">14:22:15</span></div>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Dorflex 500mg</span><span>R$ 15,90</span></div>
                        <div class="item-row"><span><span class="item-qty">1x</span> Paracetamol 750mg</span><span>R$ 8,00</span></div>
                        <div class="item-row"><span><span class="item-qty">1x</span> Vick Vaporub 12g</span><span>R$ 28,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 51,90</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2026-01-06">
                    <div class="order-header">
                        <div><span class="order-id">ID: #89044</span><span class="order-date">Ontem (06 Jan) • 10:15</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-info-grid">
                        <div class="info-item"><span class="info-label">Máquina</span><span class="info-value">M05 - Estação</span></div>
                        <div class="info-item"><span class="info-label">Pagamento</span><span class="info-value">Débito</span></div>
                        <div class="info-item"><span class="info-label">Status</span><span class="info-value">Finalizado</span></div>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">2x</span> Vitamina C 1g</span><span>R$ 22,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 22,00</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2026-01-04">
                    <div class="order-header">
                        <div><span class="order-id">ID: #88921</span><span class="order-date">04 Jan • 19:45</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-info-grid">
                        <div class="info-item"><span class="info-label">Máquina</span><span class="info-value">M01 - Praça Central</span></div>
                        <div class="info-item"><span class="info-label">Pagamento</span><span class="info-value">PIX</span></div>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Neosaldina 30drg</span><span>R$ 19,50</span></div>
                        <div class="item-row"><span><span class="item-qty">1x</span> Band-aid 10un</span><span>R$ 7,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 26,50</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2026-01-02">
                    <div class="order-header">
                        <div><span class="order-id">ID: #88750</span><span class="order-date">02 Jan • 08:30</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-info-grid">
                        <div class="info-item"><span class="info-label">Máquina</span><span class="info-value">M03 - Aeroporto</span></div>
                        <div class="info-item"><span class="info-label">Pagamento</span><span class="info-value">Crédito</span></div>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">3x</span> Eno 5g</span><span>R$ 13,50</span></div>
                        <div class="item-row"><span><span class="item-qty">1x</span> Omeprazol 20mg</span><span>R$ 22,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 35,50</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2025-12-30">
                    <div class="order-header">
                        <div><span class="order-id">ID: #88500</span><span class="order-date">30 Dez • 21:15</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Centrum A-Z</span><span>R$ 85,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 85,00</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2025-12-25">
                    <div class="order-header">
                        <div><span class="order-id">ID: #88210</span><span class="order-date">25 Dez • 11:00</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Benegrip 6 Comp.</span><span>R$ 21,00</span></div>
                        <div class="item-row"><span><span class="item-qty">2x</span> Paracetamol 750mg</span><span>R$ 16,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 37,00</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2025-12-20">
                    <div class="order-header">
                        <div><span class="order-id">ID: #87990</span><span class="order-date">20 Dez • 14:00</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Nebacetin 15g</span><span>R$ 19,00</span></div>
                        <div class="item-row"><span><span class="item-qty">1x</span> Merthiolate Spray</span><span>R$ 24,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 43,00</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2025-12-15">
                    <div class="order-header">
                        <div><span class="order-id">ID: #87500</span><span class="order-date">15 Dez • 09:30</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">5x</span> Dorflex 10 Comp.</span><span>R$ 79,50</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 79,50</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2025-12-10">
                    <div class="order-header">
                        <div><span class="order-id">ID: #87001</span><span class="order-date">10 Dez • 18:20</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Allegra 120mg</span><span>R$ 45,00</span></div>
                        <div class="item-row"><span><span class="item-qty">2x</span> Luftal 125mg</span><span>R$ 38,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 83,00</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2025-12-01">
                    <div class="order-header">
                        <div><span class="order-id">ID: #86550</span><span class="order-date">01 Dez • 07:45</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Torsilax 30 Comp.</span><span>R$ 12,00</span></div>
                        <div class="item-row"><span><span class="item-qty">1x</span> Buscopan 20 Drg.</span><span>R$ 16,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 28,00</span></div>
                </div>

                <div class="order-card" data-status="retirado" data-date-raw="2025-11-20">
                    <div class="order-header">
                        <div><span class="order-id">ID: #85400</span><span class="order-date">20 Nov • 13:10</span></div>
                        <span class="status-badge status-retirado">Retirado</span>
                    </div>
                    <div class="order-items-box">
                        <div class="item-row"><span><span class="item-qty">1x</span> Advil 400mg</span><span>R$ 25,00</span></div>
                        <div class="item-row"><span><span class="item-qty">1x</span> Polaramine 2mg</span><span>R$ 18,00</span></div>
                    </div>
                    <div class="order-footer"><span class="info-label">Total Pago</span><span class="total-value">R$ 43,00</span></div>
                </div>

            </div>
        </div>

        <div id="notLoggedState" class="status-container">
            <span class="material-icons">lock_person</span>
            <h3>Acesse sua conta</h3>
            <p>Para visualizar seu histórico de pedidos e o status das suas compras, você precisa estar logado.</p>
            <button class="btn-action" onclick="openLoginModal()">ENTRAR OU CADASTRAR</button>
        </div>
    </main>

    <div id="loginModal" class="login-modal-overlay" onclick="closeLoginModal()">
        <div class="login-modal-content" onclick="event.stopPropagation()">
            <div class="modal-drag-handle"></div>
            <div id="loginContentArea"></div>
        </div>
    </div>

    <nav class="mobile-footer">
        <a href="loja_mobile.html" class="nav-item"><span class="material-icons">store</span><span>LOJA</span></a>
        <a href="pedidos_mobile.html" class="nav-item active"><span class="material-icons">assignment</span><span>PEDIDOS</span></a>
        <a href="ofertas_mobile.html" class="nav-item"><span class="material-icons">local_offer</span><span>OFERTAS</span></a>
        <a href="favoritos_mobile.html" class="nav-item"><span class="material-icons">favorite</span><span>FAVORITOS</span></a>
        <a href="perfil_mobile.html" class="nav-item"><span class="material-icons">person</span><span>PERFIL</span></a>
    </nav>

    <script>
        function openLoginModal() {
            fetch('login_mobile.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('loginContentArea').innerHTML = data;
                    document.getElementById('loginModal').classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function checkLogin() {
            const user = sessionStorage.getItem('usuarioFarmaFacil');
            const contentLogged = document.getElementById('contentLogged');
            const notLoggedState = document.getElementById('notLoggedState');
            const filterArea = document.getElementById('filterArea');

            if (user) {
                contentLogged.style.display = 'block';
                notLoggedState.style.display = 'none';
                filterArea.style.visibility = 'visible';
            } else {
                contentLogged.style.display = 'none';
                notLoggedState.style.display = 'flex';
                filterArea.style.visibility = 'hidden';
            }
        }

        function abrirCalendario() {
            const input = document.getElementById('dateInput');
            try { input.showPicker(); } catch (e) { input.click(); }
        }

        function filtrarGeral() {
            const busca = document.getElementById('searchInput').value.toLowerCase();
            const cards = document.getElementsByClassName('order-card');
            for (let card of cards) {
                const id = card.querySelector('.order-id').innerText.toLowerCase();
                const itens = card.querySelector('.order-items-box').innerText.toLowerCase();
                card.style.display = (id.includes(busca) || itens.includes(busca)) ? "" : "none";
            }
        }

        function filtrarPorDataCalendario() {
            const dataSelecionada = document.getElementById('dateInput').value;
            const cards = document.getElementsByClassName('order-card');
            document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
            if(!dataSelecionada) return;
            for (let card of cards) {
                const dataCard = card.getAttribute('data-date-raw');
                card.style.display = (dataCard === dataSelecionada) ? "" : "none";
            }
        }

        function aplicarFiltroChip(tipo, element) {
            document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
            element.classList.add('active');
            document.getElementById('dateInput').value = "";
            const cards = document.getElementsByClassName('order-card');
            const hoje = "2026-01-07"; // Atualizado para a data de "hoje" no contexto
            for (let card of cards) {
                const status = card.getAttribute('data-status');
                const dataRaw = card.getAttribute('data-date-raw');
                if (tipo === 'todos') card.style.display = "";
                else if (tipo === 'pendente') card.style.display = (status === 'pendente') ? "" : "none";
                else if (tipo === 'hoje') card.style.display = (dataRaw === hoje) ? "" : "none";
                else if (tipo === 'retirado') card.style.display = (status === 'retirado') ? "" : "none";
            }
        }

        window.onload = () => {
            checkLogin();
        };
    </script>
</body>
</html>